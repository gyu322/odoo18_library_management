<?xml version="1.0" encoding="UTF-8"?>

<odoo>
    <!-- List view of library.librarian model (start)-->
    <record id="library_librarian_list_view" model="ir.ui.view">
        <field name="name">Library Librarian List View</field>
        <field name="model">library.librarian</field>
        <field name="arch" type="xml">
            <list decoration-muted="not active">
                <field name="name"/>
                <field name="employee_id"/>
                <field name="department" widget="badge"/>
                <field name="position" widget="badge"/>
                <field name="email"/>
                <field name="phone"/>
                <field name="hire_date"/>
                <field name="years_of_service"/>
                <field name="total_managed_borrowings"/>
                <field name="active" widget="boolean_toggle"/>
                <button name="action_view_managed_borrowings" type="object" string="View Borrowings" 
                        class="btn-secondary" invisible="total_managed_borrowings == 0"/>
            </list>
        </field>
    </record>
    <!-- List view of library.librarian model (end)-->

    <!-- Form view of library.librarian model (start)-->
    <record id="library_librarian_form_view" model="ir.ui.view">
        <field name="name">Library Librarian Form View</field>
        <field name="model">library.librarian</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="action_view_managed_borrowings" string="View Managed Borrowings" type="object" 
                            class="btn-primary" invisible="total_managed_borrowings == 0"/>
                    <button name="toggle_active" string="Activate" type="object" 
                            class="btn-success" invisible="active"/>
                    <button name="toggle_active" string="Deactivate" type="object" 
                            class="btn-warning" invisible="not active"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="action_view_managed_borrowings" type="object" class="oe_stat_button" icon="fa-book">
                            <field name="total_managed_borrowings" widget="statinfo" string="Managed Borrowings"/>
                        </button>
                    </div>
                    
                    <widget name="web_ribbon" title="Inactive" bg_color="bg-danger" invisible="active"/>
                    
                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Librarian Name"/>
                        </h1>
                        <h2>
                            <field name="employee_id" placeholder="Employee ID (e.g., LIB001)"/>
                        </h2>
                    </div>
                    
                    <group>
                        <group>
                            <field name="department"/>
                            <field name="position"/>
                            <field name="hire_date"/>
                            <field name="years_of_service"/>
                        </group>
                        <group>
                            <field name="email" widget="email"/>
                            <field name="phone" widget="phone"/>
                            <field name="active"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Managed Borrowings" invisible="total_managed_borrowings == 0">
                            <field name="managed_borrowings" readonly="1">
                                <list>
                                    <field name="sequence"/>
                                    <field name="member_name"/>
                                    <field name="book_title"/>
                                    <field name="borrow_date"/>
                                    <field name="expected_return_date"/>
                                    <field name="status" widget="badge"/>
                                </list>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>
    <!-- Form view of library.librarian model (end)-->

    <!-- Search view of library.librarian model (start)-->
    <record id="library_librarian_search_view" model="ir.ui.view">
        <field name="name">Library Librarian Search View</field>
        <field name="model">library.librarian</field>
        <field name="arch" type="xml">
            <search>
                <field name="name" string="Name"/>
                <field name="employee_id" string="Employee ID"/>
                <field name="email" string="Email"/>
                <field name="department" string="Department"/>
                <field name="position" string="Position"/>
                
                <filter string="Active" name="active" 
                        domain="[('active', '=', True)]"/>
                <filter string="Inactive" name="inactive" 
                        domain="[('active', '=', False)]"/>
                        
                <separator/>
                
                <filter string="Circulation" name="circulation" 
                        domain="[('department', '=', 'circulation')]"/>
                <filter string="Reference" name="reference" 
                        domain="[('department', '=', 'reference')]"/>
                <filter string="Cataloging" name="cataloging" 
                        domain="[('department', '=', 'cataloging')]"/>
                <filter string="Administration" name="administration" 
                        domain="[('department', '=', 'administration')]"/>
                        
                <separator/>
                
                <filter string="Librarian" name="librarian" 
                        domain="[('position', '=', 'librarian')]"/>
                <filter string="Senior Librarian" name="senior_librarian" 
                        domain="[('position', '=', 'senior_librarian')]"/>
                <filter string="Head Librarian" name="head_librarian" 
                        domain="[('position', '=', 'head_librarian')]"/>
                <filter string="Assistant" name="assistant" 
                        domain="[('position', '=', 'assistant')]"/>
                        
                <separator/>
                
                <filter string="This Year Hires" name="this_year_hires" 
                        domain="[('hire_date', '>=', time.strftime('%Y-01-01'))]"/>
                <filter string="Long Service (5+ Years)" name="long_service" 
                        domain="[('years_of_service', '>=', 5)]"/>
                
                <separator/>
                
                <group expand="0" string="Group By">
                    <filter string="Department" name="group_by_department" 
                            context="{'group_by': 'department'}"/>
                    <filter string="Position" name="group_by_position" 
                            context="{'group_by': 'position'}"/>
                    <filter string="Active Status" name="group_by_active" 
                            context="{'group_by': 'active'}"/>
                    <filter string="Hire Date" name="group_by_hire_date" 
                            context="{'group_by': 'hire_date'}"/>
                </group>
            </search>
        </field>
    </record>
    <!-- Search view of library.librarian model (end)-->

    <!-- Kanban view of library.librarian model (start)-->
    <record id="library_librarian_kanban_view" model="ir.ui.view">
        <field name="name">Library Librarian Kanban View</field>
        <field name="model">library.librarian</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile">
                <field name="name"/>
                <field name="employee_id"/>
                <field name="department"/>
                <field name="position"/>
                <field name="email"/>
                <field name="phone"/>
                <field name="active"/>
                <field name="total_managed_borrowings"/>
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_card oe_kanban_global_click #{record.active.raw_value ? '' : 'o_kanban_color_2'}">
                            <div class="o_kanban_record_top">
                                <div class="o_kanban_record_headings">
                                    <strong class="o_kanban_record_title">
                                        <field name="name"/>
                                    </strong>
                                    <br/>
                                    <span class="o_kanban_record_subtitle">
                                        <field name="employee_id"/>
                                    </span>
                                </div>
                            </div>
                            <div class="o_kanban_record_body">
                                <field name="department" widget="badge"/>
                                <field name="position" widget="badge"/>
                                <br/>
                                <i class="fa fa-envelope"/> <field name="email"/>
                                <br/>
                                <i class="fa fa-phone"/> <field name="phone"/>
                            </div>
                            <div class="o_kanban_record_bottom">
                                <div class="oe_kanban_bottom_left">
                                    <span t-if="record.total_managed_borrowings.raw_value > 0">
                                        <i class="fa fa-book"/> <field name="total_managed_borrowings"/> borrowings
                                    </span>
                                </div>
                                <div class="oe_kanban_bottom_right">
                                    <field name="active" widget="boolean_toggle"/>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>
    <!-- Kanban view of library.librarian model (end)-->

    <!-- Action of library.librarian model (start)-->
    <record id="library_librarian_action" model="ir.actions.act_window">
        <field name="name">Librarians</field>
        <field name="res_model">library.librarian</field>
        <field name="view_mode">kanban,list,form</field>
        <field name="search_view_id" ref="library_librarian_search_view"/>
        <field name="context">{}</field>
        <field name="domain">['|', ('active', '=', True), ('active', '=', False)]</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create your first librarian record!
            </p>
            <p>
                Manage librarian information, track their performance, and assign library operations.
            </p>
        </field>
    </record>
    <!-- Action of library.librarian model (end)-->


</odoo>